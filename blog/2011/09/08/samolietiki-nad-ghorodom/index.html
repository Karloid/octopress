
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Самолетики над городом - blog.kalcho.ru</title>
  <meta name="author" content="Ryabko">

  
  <meta name="description" content="В пятницу днем, находясь на работе, сквозь наушники услышал мощный шум, похожий на раскаты хорошего грома.
Повернул голову к окну – вроде ясная &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ryabko.github.io/octopress/blog/2011/09/08/samolietiki-nad-ghorodom">
  <link href="/octopress/favicon.png" rel="icon">
  <link href="/octopress/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/octopress/atom.xml" rel="alternate" title="blog.kalcho.ru" type="application/atom+xml">
  <script src="/octopress/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/octopress/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/octopress/">blog.kalcho.ru</a></h1>
  
    <h2>Еще одна измученная душа</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/octopress/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ryabko.github.io/octopress" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/octopress/">Главная</a></li>
   <li><a href="/octopress/contacts">Контакты</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Самолетики над городом</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-08T00:34:00+04:00" pubdate data-updated="true">Sep 8<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>В пятницу днем, находясь на работе, сквозь наушники услышал мощный шум, похожий на раскаты хорошего грома.
Повернул голову к окну – вроде ясная погода – продолжил работу.</p>

<p>Спустя какое-то время выхожу на обед – у крыльца выстроились коллеги, которые, оказывается,
смотрят на пролетающие по улице самолеты. Они-то мне и рассказали, что самолеты прилетели из Липецка
и что они репетируют перед субботним выступлением в честь Дня города в Воронеже.
Ума не приложу, откуда они все знают, но все действительно так и оказалось.</p>

<!-- more -->


<p>Я бы, наверное, специально никуда не пошел, но в субботу опять был на работе, и грех было не выйти посмотреть. Увиденным доволен. У нас все-таки тоже бывает что-то интересненькое, пусть и раз в 425 лет (старожилы утверждают, что авиашоу в Воронеже бывало и раньше).</p>

<p>Приехавшие посмотреть на это автолюбители заполонили машинами все тротуары на центральных улицах. По улице Орджоникидзе, например, в это время вообще нереально было проехать.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/ordz-autos.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/ordz-autos-640x480.jpg" title="Автомобили на ул. Орджоникидзе" alt="Автомобили на ул. Орджоникидзе" /></a></p>

<p>На газоне у драмтеатра толпа народу.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/dram-park.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/dram-park-640x480.jpg" title="Люди у драмтеатра" alt="Люди у драмтеатра" /></a></p>

<p>Но мы-то знаем, что это не самое лучшее место. Идем дальше к Дому Детей и Юношества, обходим его с левой стороны и попадаем на площадку, с которой отлично просматривается водохранилище (и, кстати, видно все три моста). Оказывается, не мы одни знаем это место, и народу тут полно. Но это не проблема: площадка большая, и место найдется всем.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/ddu-place.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/ddu-place-640x480.jpg" title="Площадка у ДДЮ" alt="Площадка у ДДЮ" /></a></p>

<p>С Чернавского моста, наверное, тоже неплохо было видно. Многие смотрели оттуда.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/chern-autos.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/chern-autos-640x480.jpg%20%D0%A7%D0%B5%D1%80%D0%BD%D0%B0%D0%B2%D1%81%D0%BA%D0%B8%D0%B9%20%D0%BC%D0%BE%D1%81%D1%82" title="" alt="Чернавский мост" /></a></p>

<p>А теперь самолетики.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air01.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air01-640x480.jpg" title="Самолетики" alt="Самолетики" /></a></p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air02.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air02-640x480.jpg" title="Самолетики" alt="Самолетики" /></a></p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air03.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air03-640x480.jpg" title="Самолетики" alt="Самолетики" /></a></p>

<p>И облака были красивые. Как в Спрингфилде.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/clouds.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/clouds-640x480.jpg" title="Облака" alt="Облака" /></a></p>

<p>Особо состоятельные смотрели прямо с воды. Катеров и всяких лодок было несколько десятков.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/boats.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/boats-640x480.jpg" title="Особо состоятельные смотрят с лодок" alt="Особо состоятельные смотрят с лодок" /></a></p>

<p>Еще самолетики.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air04.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air04-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air05.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air05-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air06.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air06-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air08.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air08-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air09.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air09-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air10.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air10-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air11.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air11-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air12.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air12-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air13.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air13-640x480.jpg" alt="Самолетики"  />()</p>

<p>А теперь маленький салют.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/fireworks.jpg"><img title="Салют" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/fireworks-640x480.jpg" alt="Салют"  />()</p>

<p>Расходитесь, здесь больше не на что смотреть.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/go-out.jpg"><img title="Расходимся" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/go-out-640x480.jpg" alt="Расходимся"  />()</p>

<p>А поднявшись к площади Детей, смотреть уже есть на что. Немного употребивший паренек пытается, что-то напевая, дирижировать случайно попавшимися ему под руку двумя взводами курсантов.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers.jpg"><img title="Паренек пытается дирижировать курсантами" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers-640x480.jpg" alt="Паренек пытается дирижировать курсантами"  />()</p>

<p>Те ржут и снимают его выступление на мобилы.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers2.jpg"><img title="Курсанты ржут и снимают пацана на мобилы" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers2-640x480.jpg" alt="Курсанты ржут и снимают пацана на мобилы"  />()</p>

<p>Потом им надоедает, и они его прогоняют. Даже показывают, куда идти надо.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers3.jpg"><img title="Пацана прогоняют" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers3-640x480.jpg" alt="Пацана прогоняют"  />()</p>

<p>Видео-бонус: самолетики над головой.</p>

<iframe width="425" height="349" src="http://www.youtube.com/embed/Wr-XQ8U080E?hl=en&#038;fs=1" frameborder="0" allowfullscreen></iframe>


<p>Видео-бонус 2: крутящийся самолетик. И я извиняюсь за дрожащие руки.</p>

<iframe width="425" height="349" src="http://www.youtube.com/embed/FBlf20zQ0S8?hl=en&#038;fs=1" frameborder="0" allowfullscreen></iframe>


<p>Фото-бонус: вид с правого берега на жилой комплекс &laquo;Белые Паруса&raquo; на ул. МОПРа.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/white-sails.jpg"><img title="Жилой комплекс &quot;Белые паруса&quot;" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/white-sails-640x480.jpg" alt="Жилой комплекс &quot;Белые паруса&quot;"  />()</p>

<p>Фото-бонус 2: вид с правого берега на домик с выемкой на остановке Брусилова.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/brusilova.jpg"><img title="Домик на остановке Брусилова" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/brusilova-640x480.jpg" alt="Домик на остановке Брусилова"  />()</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ryabko</span></span>

      








  


<time datetime="2011-09-08T00:34:00+04:00" pubdate data-updated="true">Sep 8<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/octopress/blog/categories/voroniezh/'>Воронеж</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://ryabko.github.io/octopress/blog/2011/09/08/samolietiki-nad-ghorodom/" data-via="" data-counturl="http://ryabko.github.io/octopress/blog/2011/09/08/samolietiki-nad-ghorodom/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/octopress/blog/2011/05/01/malien%27kiie-triuki-s-posliedovatiel%27nostiami-oracle/" title="Previous Post: Маленькие трюки с последовательностями Oracle">&laquo; Маленькие трюки с последовательностями Oracle</a>
      
      
        <a class="basic-alignment right" href="/octopress/blog/2012/08/30/moskva-avgust-2012/" title="Next Post: Москва, август 2012">Москва, август 2012 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Свежие записи</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/octopress/blog/2012/08/30/moskva-avgust-2012/">Москва, август 2012</a>
      </li>
    
      <li class="post">
        <a href="/octopress/blog/2011/09/08/samolietiki-nad-ghorodom/">Самолетики над городом</a>
      </li>
    
      <li class="post">
        <a href="/octopress/blog/2011/05/01/malien%27kiie-triuki-s-posliedovatiel%27nostiami-oracle/">Маленькие трюки с последовательностями Oracle</a>
      </li>
    
  </ul>
  <h1>Рубрики</h1>
  <ul>
    
      <li><a href="/octopress/blog/categories/<p>Это небольшая история о том, как задача, обещавшая быть нудной и монотонной,
после небольших размышлений превратилась в увлекательное занятие.
Конечно, увлекательным его найдет только тот, кому процесс программирования не менее важен,
чем результат, и тот, для кого чем процесс непривычнее и нестандартнее, тем лучше.</p>

<!-- more -->


<h2>Предыстория</h2>

<p>У нас в компании есть одно большое-большое приложение. Оно помогает управлять всеми бизнес-процессами организации. Помогает давно и довольно надежно, поэтому что-то принципиальное менять в нем нежелательно. Приложение написано на <a href="http://ru.wikipedia.org/wiki/Oracle_Forms">Oracle Forms</a>, а это значит, что с базой данных оно связано неразрывно: много логики спрятано в процедурах и функциях базы, триггерах, джобах.</p>

<p>Как известно, для генерации идентификаторов в Oracle обычно используются последовательности &#8211; специальные объекты, которые умеют возвращать очередное число из заданного ряда. Помимо последовательности создается триггер, который срабатывает при вставке новой записи в таблицу. Триггер обращается к последовательности, получает число и вставляет его в поле идентификатора.</p>

<p>В нашем же приложении в некоторых таблицах в качестве идентификатора используется не то же самое число, которое было выдано последовательностью, а немного измененное. После того, как триггер получает из последовательности очередное число, он передает его в нашу специальную функцию <code>GENERATE_ID</code>. Эта функция дописывает в конец переданного числа определенную цифру, которая выбирается в зависимости от некоторых условий. Полученное число используется в качестве идентификатора.</p>

<p>Сейчас уже поздно рассуждать о плюсах и минусах такого подхода. Я не знаю целей, для которых так было сделано. Да и в принципы работы этого приложения я особо не вникал, поскольку разрабатывалось оно без моего участия, а в своей работе я его не использую.</p>

<p>И не вникал бы и дальше, если бы нам не потребовалось сделать еще одно приложение на той же базе. И не просто на той же базе &#8211; а с теми же таблицами и с теми же данными, поскольку новое приложение тоже должно оперировать информацией о наших клиентах, договорах, заказах и т.п. По многим причинам реализовать новое приложение решили на <a href="http://ru.wikipedia.org/wiki/EJB">EJB</a>. Для облегчения доступа к данным в EJB используется технология <a href="http://en.wikipedia.org/wiki/Java_Persistence_API">JPA</a>, позволяющая задать соответствие между классами приложения и таблицами в базе данных. Генерацию идентификаторов JPA также берет на себя, самостоятельно обращаясь к нужным последовательностям, а затем явно передавая полученное число в качестве идентификатора при вставке в таблицу новой записи. Триггер же устроен так, что если при вставке новой записи идентификатор указан явно, то никаких дополнительных действий не делается. И здесь, как и следовало ожидать, возникла&#8230;</p>

<h2>Проблема</h2>

<p>Получилось, что два приложения при генерации идентификатора для одной и той же таблицы используют разные алгоритмы: старое приложение (с помощью триггера) берет число из последовательности и дописывает к нему цифру, а новое (посредством JPA) &#8211; просто берет число из последовательности. Это чревато конфликтами, т.е. генерацией идентификаторов, которые уже есть в таблице, и такие конфликты не заставили себя ждать. Очень скоро новое приложение стало периодически сообщать о том, что не может добавить запись в таблицу из-за нарушения уникальности первичного ключа.</p>

<h2>Быстрое решение</h2>

<p>Новому приложения неважно, как выглядит идентификатор и на какую цифру он заканчивается, а значит использовать функцию <code>GENERATE_ID</code> в нем необязательно. А небольшое исследование старого приложения показало, что цифра, приписываемая этой функцией к идентификатору, никогда не может быть нулем. Исходя из этого, в качестве решения проблемы было принято следующее: сделать так, чтобы последовательности, которых касается эта проблема, всегда выдавали значения, заканчивающиеся на ноль. Тогда в новом приложении идентификаторы будут всегда заканчиваться на ноль, а в старом &#8211; на какую-нибудь другую, приписываемую, цифру.</p>

<p>Сделать так, чтобы выдаваемое последовательностью значение всегда заканчивалось на ноль, несложно. Сначала нужно несколько раз выбрать из последовательности значение таким запросом:</p>

<pre><code>`select название_последовательности.nextval from dual`
</code></pre>

<p>Выполнять этот запрос нужно до тех пор, пока не будет получено число, заканчивающееся на ноль. Затем нужно задать шаг последовательности равным 10.</p>

<pre><code>`alter sequence название_последовательности increment by 10`
</code></pre>

<p>Описанные действия были проделаны над всеми последовательностями, работа с которыми приводила к ошибкам. Ошибки сначала исчезли, но, как оказалось, не навсегда. Дело в том, что последовательностей, потенциально подверженных этим проблемам, оказалось довольно много, и исправлена была только часть из них. Найти же их все оказалось не так-то просто. Сначала действовали опытным путем. Как только замечали ошибку, связанную с какой-либо последовательностью, эту последовательность тут же исправляли описанным выше способом. Со временем таких найденных и исправленных последовательностей становилось все больше, а ошибки появлялись все реже.</p>

<p>Пришел декабрь &#8211; время демонстрации нового приложения руководству. Конфликты в последовательностях уже давно не давали о себе знать, но не было никакой уверенности в том, что не осталось последовательностей, которые в самый неподходящий момент могут выдать уже существующее в таблице значение.</p>

<p>Работы по новому проекту, запланированные на 2010 год, были в основном завершены; в воздухе витал дух приближающегося нового года &#8211; в общем, самое время заняться чем-нибудь очень интересным, а заодно и окончательно разобраться с этими последовательностями.</p>

<h2>Ненормальное программирование</h2>

<p>Я решил найти абсолютно все последовательности, которые могли бы нам когда-нибудь доставить описанные выше проблемы. При этом хотелось, чтобы, во-первых, эти последовательности были найдены если не в автоматическом, то хотя бы в полуавтоматическом режиме, а во-вторых, чтобы я при этом узнал для себя что-нибудь новое, полезное и интересное.</p>

<h3>Поиск последовательностей в базе</h3>

<p>Как было описано ранее, в старом приложении используется функция <code>GENERATE_ID</code>, вызываемая из триггера и дописывающая к сгенерированному последовательностью числу какую-нибудь цифру. Значит, чтобы выбрать те последовательности, которые представляют опасность для нового проекта, нужно найти все последовательности, которые используются в тех же триггерах, в которых используется функция <code>GENERATE_ID</code>.</p>

<p>Вместо того, чтобы просматривать исходники всех триггеров, я решил обойтись одним запросом. В Oracle есть множество специальных представлений, из которых можно получить различную служебную информацию. Сначала я рассчитывал найти представление, из которого можно получить исходные коды триггеров, и с помощью оператора <code>LIKE</code> найти триггеры, использующие функцию <code>GENERATE_ID</code>. Но конечной моей целью был все-таки список последовательностей, а не список триггеров, и я нашел еще более подходящее мне представление &#8211; <code>ALL_DEPENDENCIES</code>. Это представление содержит информацию обо всех зависимостях между объектами базы данных. Основными полями этого представления являются следующие:</p>

<ul>
<li><code>NAME</code> &#8211; название использующего объекта</li>
<li><code>TYPE</code> &#8211; тип использующего объекта</li>
<li><code>REFERENCED_NAME</code> &#8211; название используемого объекта</li>
<li><code>REFERENCED_TYPE</code> &#8211; тип используемого объекта</li>
</ul>


<p>Нужные нам последовательности можно получить с помощью такого запроса:</p>

<pre><code>`select referenced_name from all_dependencies
where name in (
    select name from all_dependencies
    where referenced_name = 'GENERATE_ID' and type = 'TRIGGER'
) and referenced_type = 'SEQUENCE'`
</code></pre>

<p>Подзапрос выбирает названия всех объектов, являющихся триггерами, которые используют функцию <code>GENERATE_ID</code>. Основной запрос выбирает названия всех объектов, являющихся последовательностями и использующихся в триггерах, названия которых выбраны подзапросом.</p>

<p>Этот запрос вернул мне около 100 последовательностей. Изменять их все не было надобности, т.к. большинство из них в новом проекте не используются. Значит следующим шагом должно стать нахождение последовательностей, использующихся в новом проекте.</p>

<h3>Поиск последовательностей в проекте</h3>

<p>Названия использующихся последовательностей можно найти в исходном коде проекта. На компьютере установлен Linux, а значит для поиска можно задействовать всю мощь командной строки.</p>

<p>Если в какую-то таблицу базы данных возможна вставка записей из приложения, то для класса, соответствующего этой таблице, с помощью специальной аннотации указывается последовательность, из которой нужно брать значения для новых идентификаторов. Например:</p>

<pre><code>`@SequenceGenerator(name=”CLIENT_SEQ”, sequenceName=”КЛИЕНТЫ_SEQ”)
public class Client {
    ...
}`
</code></pre>

<p>Такая запись означает, что при сохранении в базу нового клиента для него будет использоваться идентификатор, полученный из последовательности <code>КЛИЕНТЫ_SEQ</code>.</p>

<p>Значит, чтобы найти все последовательности, использующиеся в проекте, нужно в файлах исходных кодов найти все подстроки, заключенные в кавычки и идущие после подстроки seqeunceName. Сделать это можно несколькими командами, последовательно передавая выходные данные одной команды на вход другой с помощью символа «|».</p>

<p>Для поиска всех файлов с исходными кодами можно воспользоваться командой find:</p>

<pre><code>`find ~/project/src -name ‘*.java’`
</code></pre>

<p>Эта команда выведет список всех файлов с расширением java из каталога ~/project/src.</p>

<p>Теперь нужно просмотреть содержимое всех файлов. В проекте используется кодировка cp1251, а на консоль у меня нормально выводится только содержимое файлов в кодировке utf8. На лету перекодировать файл при выводе на консоль можно с помощью команды iconv:</p>

<pre><code>`find ~/project/src -name ‘*.java’ | xargs iconv -f cp1251 -t utf8`
</code></pre>

<p>Команда <code>xargs</code> здесь указывает команде <code>iconv</code>, что та в качестве своих аргументов должна использовать результаты работы команды <code>find</code>, т.е. список найденных файлов. А с помощью опций <code>f</code> и <code>t</code> задаются входная и выходная кодировки. Результатом работы этих команд станет вывод на консоль содержимого всех файлов с расширением java из каталога ~/project/src.</p>

<p>Нас интересуют только строки, содержащие <code>sequenceName</code>. Отобрать их можно с помощью известной команды <code>grep</code>, дописав ее в конец описанной ранее последовательности команд:</p>

<pre><code>`… | grep sequenceName`
</code></pre>

<p>Теперь из полученных строк нужно извлечь названия последовательностей. Первой попавшейся мне на глаза утилитой для работы с регулярными выражениями, оказалась утилита <code>sed</code>. В частности эта утилита умеет заменять подстроку, соответствующую заданному регулярному выражению на другую строку. Вместо придумывания одного сложного регулярного выражения гораздо быстрей оказалось написать несколько простых, применяя их по очереди:</p>

<pre><code>`… | sed "s/\(.*sequenceName\)//" | sed "s/\([^\"]*\"\)//" 
| sed "s/\(\".*\)//"`
</code></pre>

<p>Оператор <code>s///</code> утилиты <code>sed</code> как раз и выполняет нужную нам замену. Между первым и вторым слешем этого оператора задается регулярное выражение, а между вторым и третим &#8211; строка для замены.</p>

<p>В нашем случае сначала строка от начала и до seqenceName включительно заменяется на пустую строку, т.е. обрезается. Затем в оставшейся строке обрезается ее часть от начала и до первой кавычки включительно. И третьим вызовом обрезается часть строки от оставшейся кавычки и до конца. После таких манипуляций от строки остается только название последовательности.</p>

<p>Итак, полная команда, выводящая на консоль список всех последовательностей приложения, выглядит следующим образом:</p>

<pre><code>`find ~/project/src -name ‘*.java’ | xargs iconv -f cp1251 -t utf8
| grep sequenceName | sed "s/\(.*sequenceName\)//"
| sed "s/\([^\"]*\"\)//" | sed "s/\(\".*\)//"`
</code></pre>

<p>В результате работы этой команды получен список примерно 60 последовательностей, использующихся в приложении.</p>

<h3>Финальный аккорд</h3>

<p>Теперь осталось только найти пересечение списка последовательностей, полученных из базы, со списком, полученным из приложения. Для этого я решил сформировать конструкцию <code>IN</code> из полученных в консоли названий последовательностей и дописать эту конструкцию в запрос к базе.</p>

<p>В SQL аргументом конструкции <code>IN</code>, как известно, является перечисление через запятую всех возможных значений, разделяемых запятыми. Строковые значения при этом должны быть взяты в апострофы. Для того, чтобы сформировать такую конструкцию из наших последовательностей, нужно к описанной выше цепочке команд для поиска последовательностей по проекту, добавить еще одну &#8211; форматирующую вывод в нужном нам виде:</p>

<pre><code>`… | sed "s/.*/'\0',/"`
</code></pre>

<p>Эта команда перед выводом названия последовательности на консоль обрамляет его апострофами, а в конце добавляет запятую. Получим примерно следующее:</p>

<pre><code>`‘КЛИЕНТЫ_SEQ’,
‘ЗАКАЗЫ_SEQ’,
‘ДОГОВОРЫ_SEQ’,
…`
</code></pre>

<p>Для того, чтобы использовать эти строки в запросе в операторе <code>IN</code>, нужно лишь поставить открывающуюся скобку перед первой строкой, закрывающуюся &#8211; после последней, а также стереть последнюю запятую. В итоге получим такой запрос:</p>

<pre><code>`select referenced_name from all_dependencies
where name in (
    select name from all_dependencies
    where referenced_name = 'GENERATE_ID' and type = 'TRIGGER'
) and referenced_type = 'SEQUENCE'
and referenced_name in (‘КЛИЕНТЫ_SEQ’, ‘ЗАКАЗЫ_SEQ’, … , ‘ДОГОВОРЫ_SEQ’)`
</code></pre>

<p>Все последовательности, полученные с помощью такого запроса, изменяем по уже описанной методике таким образом, чтобы они возвращали значение, оканчивающееся на ноль, и надеемся, что они нам больше никогда проблем не доставят.</p>

<h2>Итоги</h2>

<p>Возможно, проблемы с самого начала можно было избежать. Возможно, решить проблему можно было более простым способом. Возможно, проблема себя не изжила и когда-нибудь еще проявится. Но на данный момент задача решена, а я, решая ее, очень интересно провел несколько часов своей жизни.</p>

<h2>Ссылки</h2>

<ul>
<li><a href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14237/toc.htm">http://download.oracle.com/docs/cd/B19306_01/server.102/b14237/toc.htm</a> &#8211; Oracle® Database Reference 10g Release 2 (10.2) &#8211; документ, в котором можно найти описание всех служебных представлений Oracle.</li>
</ul>

/">Программирование</a> [ 1 ]</li>
    
      <li><a href="/octopress/blog/categories/<p>В пятницу днем, находясь на работе, сквозь наушники услышал мощный шум, похожий на раскаты хорошего грома.
Повернул голову к окну – вроде ясная погода – продолжил работу.</p>

<p>Спустя какое-то время выхожу на обед – у крыльца выстроились коллеги, которые, оказывается,
смотрят на пролетающие по улице самолеты. Они-то мне и рассказали, что самолеты прилетели из Липецка
и что они репетируют перед субботним выступлением в честь Дня города в Воронеже.
Ума не приложу, откуда они все знают, но все действительно так и оказалось.</p>

<!-- more -->


<p>Я бы, наверное, специально никуда не пошел, но в субботу опять был на работе, и грех было не выйти посмотреть. Увиденным доволен. У нас все-таки тоже бывает что-то интересненькое, пусть и раз в 425 лет (старожилы утверждают, что авиашоу в Воронеже бывало и раньше).</p>

<p>Приехавшие посмотреть на это автолюбители заполонили машинами все тротуары на центральных улицах. По улице Орджоникидзе, например, в это время вообще нереально было проехать.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/ordz-autos.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/ordz-autos-640x480.jpg" title="Автомобили на ул. Орджоникидзе" alt="Автомобили на ул. Орджоникидзе" /></a></p>

<p>На газоне у драмтеатра толпа народу.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/dram-park.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/dram-park-640x480.jpg" title="Люди у драмтеатра" alt="Люди у драмтеатра" /></a></p>

<p>Но мы-то знаем, что это не самое лучшее место. Идем дальше к Дому Детей и Юношества, обходим его с левой стороны и попадаем на площадку, с которой отлично просматривается водохранилище (и, кстати, видно все три моста). Оказывается, не мы одни знаем это место, и народу тут полно. Но это не проблема: площадка большая, и место найдется всем.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/ddu-place.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/ddu-place-640x480.jpg" title="Площадка у ДДЮ" alt="Площадка у ДДЮ" /></a></p>

<p>С Чернавского моста, наверное, тоже неплохо было видно. Многие смотрели оттуда.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/chern-autos.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/chern-autos-640x480.jpg%20%D0%A7%D0%B5%D1%80%D0%BD%D0%B0%D0%B2%D1%81%D0%BA%D0%B8%D0%B9%20%D0%BC%D0%BE%D1%81%D1%82" title="" alt="Чернавский мост" /></a></p>

<p>А теперь самолетики.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air01.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air01-640x480.jpg" title="Самолетики" alt="Самолетики" /></a></p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air02.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air02-640x480.jpg" title="Самолетики" alt="Самолетики" /></a></p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air03.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air03-640x480.jpg" title="Самолетики" alt="Самолетики" /></a></p>

<p>И облака были красивые. Как в Спрингфилде.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/clouds.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/clouds-640x480.jpg" title="Облака" alt="Облака" /></a></p>

<p>Особо состоятельные смотрели прямо с воды. Катеров и всяких лодок было несколько десятков.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/boats.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2011/09/boats-640x480.jpg" title="Особо состоятельные смотрят с лодок" alt="Особо состоятельные смотрят с лодок" /></a></p>

<p>Еще самолетики.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air04.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air04-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air05.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air05-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air06.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air06-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air08.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air08-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air09.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air09-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air10.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air10-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air11.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air11-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air12.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air12-640x480.jpg" alt="Самолетики"  />()</p>

<p><a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/air13.jpg"><img title="Самолетики" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/air13-640x480.jpg" alt="Самолетики"  />()</p>

<p>А теперь маленький салют.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/fireworks.jpg"><img title="Салют" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/fireworks-640x480.jpg" alt="Салют"  />()</p>

<p>Расходитесь, здесь больше не на что смотреть.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/go-out.jpg"><img title="Расходимся" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/go-out-640x480.jpg" alt="Расходимся"  />()</p>

<p>А поднявшись к площади Детей, смотреть уже есть на что. Немного употребивший паренек пытается, что-то напевая, дирижировать случайно попавшимися ему под руку двумя взводами курсантов.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers.jpg"><img title="Паренек пытается дирижировать курсантами" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers-640x480.jpg" alt="Паренек пытается дирижировать курсантами"  />()</p>

<p>Те ржут и снимают его выступление на мобилы.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers2.jpg"><img title="Курсанты ржут и снимают пацана на мобилы" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers2-640x480.jpg" alt="Курсанты ржут и снимают пацана на мобилы"  />()</p>

<p>Потом им надоедает, и они его прогоняют. Даже показывают, куда идти надо.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers3.jpg"><img title="Пацана прогоняют" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/soldiers3-640x480.jpg" alt="Пацана прогоняют"  />()</p>

<p>Видео-бонус: самолетики над головой.</p>

<iframe width="425" height="349" src="http://www.youtube.com/embed/Wr-XQ8U080E?hl=en&#038;fs=1" frameborder="0" allowfullscreen></iframe>


<p>Видео-бонус 2: крутящийся самолетик. И я извиняюсь за дрожащие руки.</p>

<iframe width="425" height="349" src="http://www.youtube.com/embed/FBlf20zQ0S8?hl=en&#038;fs=1" frameborder="0" allowfullscreen></iframe>


<p>Фото-бонус: вид с правого берега на жилой комплекс &laquo;Белые Паруса&raquo; на ул. МОПРа.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/white-sails.jpg"><img title="Жилой комплекс &quot;Белые паруса&quot;" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/white-sails-640x480.jpg" alt="Жилой комплекс &quot;Белые паруса&quot;"  />()</p>

<p>Фото-бонус 2: вид с правого берега на домик с выемкой на остановке Брусилова.<br/>
<a href="http://blog.kalcho.ru/wp-content/uploads/2011/09/brusilova.jpg"><img title="Домик на остановке Брусилова" src="http://blog.kalcho.ru/wp-content/uploads/2011/09/brusilova-640x480.jpg" alt="Домик на остановке Брусилова"  />()</p>
/">Воронеж</a> [ 1 ]</li>
    
      <li><a href="/octopress/blog/categories/Московские коридоры, стадион «Локомотив», водные прогулки, Арбат, место сходки китайгородских геев — 
все это на фотках с традиционной ежегодной осенней поездки в Москву, которая, правда, на этот раз прошла в августе.

<!-- more -->

Первые и не очень приятные впечатления испытал еще на воронежском вокзале. В здании вокзала открылось кафе, в котором как раз в момент моего отъезда справляли свадьбу. Окна кафе выходят и на площадь перед вокзалом, и на перрон, так что спасу никакого от него нет. &laquo;Черные глаза&raquo; не оставили никаких надежд услышать &laquo;Прощание славянки&raquo;, а без &laquo;славянки&raquo; &mdash; это можно было бы билет и на какой-нибудь другой поезд взять, рублей на 400 дешевле.</p>
<p>Московские коридоры, оказывается, не отличаются от обычных.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/coridor.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/coridor-640x480.jpg" alt="Московский коридор" title="Московский коридор" width="640" height="480" class="alignnone size-medium wp-image-125" /></a></p>
<p>Правда, такого разнообразия дверных звонков ранее встречать мне не доводилось.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/rings.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/rings-480x640.jpg" alt="Дверные звонки" title="Дверные звонки" width="480" height="640" class="alignnone size-medium wp-image-126" /></a></p>
<p>Хотелось попасть на какой-нибудь футбольный матч. По времени и месту проведения самым подходящим оказался матч Локомотив &mdash; Динамо на стадионе &laquo;Локомотив&raquo; в Черкизово.<br />
К стадиону мы приехали в 10&nbsp;утра, часа за 3&nbsp; до матча. Почти никого (кроме полицейских и стюартов) еще не было.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium-640x480.jpg" alt="Стадион Локомотив" title="Стадион Локомотив" width="640" height="480" class="alignnone size-medium wp-image-128" /></a></p>
<p>На стояние в очереди и покупку билетов ушло минуты 3. Билеты взяли по 800&nbsp;р. &mdash; это места на боковую трибуну, расположенные за скамейками запасных, рядом с VIP-местами и ложей прессы.<br />
До матча оставалась еще куча времени, и можно было погулять по району.</p>
<p>ВТБ-шный вагон для перевозки денег.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/wagon.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/wagon-640x480.jpg" alt="Вагон ВТБ" title="Вагон ВТБ" width="640" height="480" class="alignnone size-medium wp-image-129" /></a></p>
<p>Московские топонимисты (или кто там названия придумывает), похоже, особо не загоняются.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/toponymy.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/toponymy-640x480.jpg" alt="Московская топонимика" title="Московская топонимика" width="640" height="480" class="alignnone size-medium wp-image-130" /></a></p>
<p>Вид на стадион с расположенного неподалеку моста.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium_from_above.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium_from_above-640x480.jpg" alt="Стадион Локомотив, вид сверху" title="Стадион Локомотив, вид сверху" width="640" height="480" class="alignnone size-medium wp-image-131" /></a></p>
<p>Когда вернулись к стадиону за час до начала матча, очередь за билетами была уже повнушительней.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium_queue.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium_queue-640x480.jpg" alt="Очередь в кассы стадиона Локомотив" title="Очередь в кассы стадиона Локомотив" width="640" height="480" class="alignnone size-medium wp-image-140" /></a></p>
<p>Локомотив на территории стадиона, который все фотографируют.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/train.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/train-640x480.jpg" alt="Паровоз на стадионе Локомотив" title="Паровоз на стадионе Локомотив" width="640" height="480" class="alignnone size-medium wp-image-136" /></a></p>
<p>А вот стадион уже в непосредственной близости.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium_nearby.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/stadium_nearby-640x480.jpg" alt="Стадион Локомотив вблизи" title="Стадион Локомотив вблизи" width="640" height="480" class="alignnone size-medium wp-image-137" /></a></p>
<p>Наши места были совсем недалеко от входа на территорию стадиона, но поскольку сквозной проход мимо VIP-зоны запрещен, пришлось обходить в другую сторону.<br />
Там стоят автобусы команд.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/buses.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/buses-640x480.jpg" alt="Автобусы Локомотива и Динамо" title="Автобусы Локомотива и Динамо" width="640" height="480" class="alignnone size-medium wp-image-132" /></a></p>
<p>Наконец-то заходим на трибуны. До поля совсем близко. Стадионы без беговых дорожек вокруг поля &mdash; это очень круто. До матча еще довольно много времени, и люди только начинают собираться. К сожалению, много народу так и не собралось. Диктор объявлял, что на матче присутствует 12&nbsp;тысяч зрителей (стадион вмещает 28&nbsp;тысяч).<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/tribunes.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/tribunes-640x480.jpg" alt="Трибуны стадиона Локомотив" title="Трибуны стадиона Локомотив" width="640" height="480" class="alignnone size-medium wp-image-138" /></a></p>
<p>Трибуны расположены в два яруса, причем кажется, что даже верхние ряды расположены очень близко к полю. Под &laquo;потолком&raquo; 2 больших экрана, на которых много чего показывали перед матчем, но во время самого матча там горел только счет, а никаких повторов голов, как я ожидал, не было.<br />
Немного мешали металлические перила, разделяющие сектора. Лучше садиться подальше от них.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/tribunes_2.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/tribunes_2-640x480.jpg" alt="Трибуны стадиона Локомотив" title="Трибуны стадиона Локомотив" width="640" height="480" class="alignnone size-medium wp-image-139" /></a></p>
<p>Оператор и мячики.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/cameraman_and_balls.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/cameraman_and_balls-640x480.jpg" alt="Оператор и мячики" title="Оператор и мячики" width="640" height="480" class="alignnone size-medium wp-image-133" /></a></p>
<p>Пальцы и полголовы Семшова, судьи и Локомотив во время исполнения гимна.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/loko.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/loko-640x480.jpg" alt="Локомотив" title="Локомотив" width="640" height="480" class="alignnone size-medium wp-image-135" /></a></p>
<p>Вратарь Динамо и сборной России Антон Шунин.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/shunin.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/shunin-640x480.jpg" alt="Антон Шунин" title="Антон Шунин" width="640" height="480" class="alignnone size-medium wp-image-134" /></a></p>
<p>Полузащитник Динамо и сборной России Игорь Семшов.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/semshov.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/semshov-640x480.jpg" alt="Игорь Семшов" title="Игорь Семшов" width="640" height="480" class="alignnone size-medium wp-image-141" /></a></p>
<p>В перерыве я все пытался высмотреть каких-нибудь известных личностей в находящемся совсем рядом VIP-секторе &mdash; узнал только Вадима Евсеева, который сидел метрах в 5 от нас. Рядом с ним сидели два каких-то мужика, к которым за автографами подходили чаще, чем к Евсееву, но их лица мне даже не показались знакомыми.</p>
<p>Потом посетили фирменный магазин лучшего футбольного клуба в России (ул.&nbsp;Красная Пресня, д.&nbsp;21). Не, не Шоколадницу.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/spartak.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/spartak-640x480.jpg" alt="Фирменный магазин Спартака" title="Фирменный магазин Спартака" width="640" height="480" class="alignnone size-medium wp-image-164" /></a></p>
<p>Там я купил себе рюкзачок и футболку.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/rucksack_tshirt.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/rucksack_tshirt-640x480.jpg" alt="Рюкзак и футболка Спартака" title="Рюкзак и футболка Спартака" width="640" height="480" class="alignnone size-medium wp-image-160" /></a></p>
<p>Четыре аббревиатуры в одном названии.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/abbreviations.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/abbreviations-640x480.jpg" alt="Аббревиатуры" title="Аббревиатуры" width="640" height="480" class="alignnone size-medium wp-image-144" /></a></p>
<p>Где-то в интернете уже видел фотку этой вывески, но вот и своими глазами приметил.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/butsa.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/butsa-640x480.jpg" alt="Бутса" title="Бутса" width="640" height="480" class="alignnone size-medium wp-image-147" /></a></p>
<p>Покатались на речном трамвайчике по Москве-реке. Билет &mdash; 400&nbsp;р. Длительность поездки &mdash; полтора часа.<br />
Экскурсоводша на цветном принтере распечатала маршрут поездки для иностранной парочки.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/guide.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/guide-640x480.jpg" alt="Экскурсовод и карта" title="Экскурсовод и карта" width="640" height="480" class="alignnone size-medium wp-image-151" /></a></p>
<p>Вид на Кремль с реки.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/kremlin.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/kremlin-640x480.jpg" alt="Кремль, вид с реки" title="Кремль, вид с реки" width="640" height="480" class="alignnone size-medium wp-image-153" /></a></p>
<p>Вид реки с реки.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/river.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/river-640x480.jpg" alt="Москва-река" title="Москва-река" width="640" height="480" class="alignnone size-medium wp-image-158" /></a></p>
<p>Огромный памятник Петру и уголок фабрики Красный Октябрь.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/piter.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/piter-640x480.jpg" alt="Памятник Петру" title="Памятник Петру" width="640" height="480" class="alignnone size-medium wp-image-156" /></a></p>
<p>Дом с какой-то непонятной фигней на крыше.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/building.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/building-640x480.jpg" alt="Здание с непонятной фигней" title="Здание с непонятной фигней" width="640" height="480" class="alignnone size-medium wp-image-146" /></a></p>
<p>Станция метро Воробьевы горы, расположенная на мосту. Если присмотреться, через окна можно разглядеть поезд.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/sparrow_mountains.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/sparrow_mountains-640x480.jpg" alt="Станция Воробьевы горы" title="Станция Воробьевы горы" width="640" height="480" class="alignnone size-medium wp-image-163" /></a></p>
<p>Как назвать юного жителя района Хамовники?<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/hamovchonok.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/hamovchonok-640x480.jpg" alt="Хамовчонок" title="Хамовчонок" width="640" height="480" class="alignnone size-medium wp-image-152" /></a></p>
<p>Рассыхающиеся и отклеивающиеся буквы чудесным образом превращаются в китайский шрифт.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/chinese.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/chinese-640x480.jpg" alt="Китайские буквы" title="Китайские буквы" width="640" height="480" class="alignnone size-medium wp-image-149" /></a></p>
<p>Подгоревшая тарелка. Интересно, показывает ли она еще что-нибудь?<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/plate.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/plate-640x480.jpg" alt="Подгоревшая тарелка" title="Подгоревшая тарелка" width="640" height="480" class="alignnone size-medium wp-image-157" /></a></p>
<p>Каточное ДТП?<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/rollers.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/rollers-640x480.jpg" alt="Катки" title="Катки" width="640" height="480" class="alignnone size-medium wp-image-159" /></a></p>
<p>По тротуарам в центре Москвы действительно бывает тяжело пройти. Так что фотки Варламова &mdash; не подделка.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/sidewalk.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/sidewalk-640x480.jpg" alt="Московский тротуар" title="Московский тротуар" width="640" height="480" class="alignnone size-medium wp-image-161" /></a></p>
<p>На Арбате есть на что посмотреть.<br />
Макдоналдс, расположенный в старинном желтом здании, выглядит довольно необычно.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/mcdonalds.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/mcdonalds-640x480.jpg" alt="Макдоналдс на Арбате" title="Макдоналдс на Арбате" width="640" height="480" class="alignnone size-medium wp-image-154" /></a></p>
<p>Старичок играет на гибриде саксофона и синтезатора.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/oldman.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/oldman-640x480.jpg" alt="Старик и музыкальный инструмент" title="Старик и музыкальный инструмент" width="640" height="480" class="alignnone size-medium wp-image-155" /></a></p>
<p>Перевода для слов &laquo;матрешка&raquo; и &laquo;хохлома&raquo;, наверное, и правда нет.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/souvenirs.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/souvenirs-640x480.jpg" alt="Матрешка и хохлома" title="Матрешка и хохлома" width="640" height="480" class="alignnone size-medium wp-image-162" /></a></p>
<p>Из списанного троллейбуса сделали кафешку.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/trolleybus.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/trolleybus-640x480.jpg" alt="Троллейбус-кафе" title="Троллейбус-кафе" width="640" height="480" class="alignnone size-medium wp-image-166" /></a></p>
<p>Смысл этого аттракциона &mdash; маленький лысый щенок и чучело крысы &mdash; мне остался не понятен.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/dog_rat.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/dog_rat-640x480.jpg" alt="Щенок и крыса" title="Щенок и крыса" width="640" height="480" class="alignnone size-medium wp-image-150" /></a></p>
<p>Дальше было поинтереснее. Дядька в респираторе, используя только баллончики с краской, пластиковую тарелку и скребок с вырезами, за несколько минут нарисовал такую картинку.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/spray.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/spray-640x480.jpg" alt="Рисунок баллончиками" title="Рисунок баллончиками" width="640" height="480" class="alignnone size-medium wp-image-165" /></a></p>
<p>Дальше у нас по пути Александровский сад. Время работы в нем туалета немножко озадачивает.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/wc.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/wc-640x480.jpg" alt="Туалет в Александровском саду" title="Туалет в Александровском саду" width="640" height="480" class="alignnone size-medium wp-image-167" /></a></p>
<p>Для москвичей, похоже, нет ничего святого. Вот этот пацан просто взял и наложил кучу под стенами Кремля.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/boy.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/boy-640x480.jpg" alt="Мальчик у Кремля" title="Мальчик у Кремля" width="640" height="480" class="alignnone size-medium wp-image-145" /></a></p>
<p>Сквер на станции метро Китай-город.<br />
<a href="http://blog.kalcho.ru/wp-content/uploads/2012/08/china_city.jpg"><img src="http://blog.kalcho.ru/wp-content/uploads/2012/08/china_city-640x480.jpg" alt="Сквер в Китай-городе" title="Сквер в Китай-городе" width="640" height="480" class="alignnone size-medium wp-image-148" /></a></p>
<p>Казалось бы: обычный сквер. Но, оказывается, это место сбора московских геев.<br />
Самих геев я фотографировать не решился. Я им и в глаза-то смотреть боялся. Сначала мимо нас прошли три парня, один из которых был с розой и воздушными шариками. Еще два мужика поцеловались при встрече. Потом на глаза попалась парочка парней с бутылкой &laquo;Молока любимой женщины&raquo;.<br />
Ну, и добил меня полненький мальчик, похожий на толстяка из Литтл Бритн, который обратился к своим друзьям томным голосом: &laquo;Дзевачки, пайдземте &mdash; дождь начинается&raquo;. Трудно было поверить в то, что он не шутит или не пародирует кого-то, но он был очень серьезен.</p>/">Путешествия</a> [ 1 ]</li>
    
  </ul>
    
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Ryabko -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
